-- Create the hero_slides_config table
CREATE TABLE public.hero_slides_config (
  id uuid PRIMARY KEY DEFAULT gen_random_uuid(), -- Primary key for the config entry itself
  media_item_id uuid NOT NULL REFERENCES public.media_items(id) ON DELETE CASCADE,
  order_index integer DEFAULT 0 NOT NULL,
  created_at timestamptz DEFAULT now() NOT NULL,
  updated_at timestamptz DEFAULT now() NOT NULL
);

-- Enable Row Level Security
ALTER TABLE public.hero_slides_config ENABLE ROW LEVEL SECURITY;

-- Trigger for updated_at timestamp
-- Assumes trigger_set_timestamp function is created from 00_setup.txt
CREATE TRIGGER set_hero_slides_config_updated_at
BEFORE UPDATE ON public.hero_slides_config
FOR EACH ROW
EXECUTE FUNCTION public.trigger_set_timestamp();

-- Add Indexes
CREATE INDEX IF NOT EXISTS idx_hero_slides_config_media_item_id ON public.hero_slides_config (media_item_id);
CREATE INDEX IF NOT EXISTS idx_hero_slides_config_order_index ON public.hero_slides_config (order_index);