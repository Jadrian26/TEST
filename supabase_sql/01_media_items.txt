-- Create the media_items table
CREATE TABLE public.media_items (
  id uuid PRIMARY KEY DEFAULT gen_random_uuid(),
  name text NOT NULL, -- Original file name
  file_path text UNIQUE NOT NULL, -- Path within Supabase Storage bucket
  mime_type text,
  size_bytes integer,
  public_url text NOT NULL, -- Public URL from Supabase Storage
  uploaded_at timestamptz DEFAULT now() NOT NULL,
  user_id_uploader uuid REFERENCES auth.users(id) ON DELETE SET NULL -- User who uploaded
  -- No updated_at needed by default for media_items, unless metadata updates are frequent
);

-- Enable Row Level Security
ALTER TABLE public.media_items ENABLE ROW LEVEL SECURITY;

-- Add Indexes
CREATE INDEX IF NOT EXISTS idx_media_items_user_id_uploader ON public.media_items (user_id_uploader);
CREATE INDEX IF NOT EXISTS idx_media_items_uploaded_at ON public.media_items (uploaded_at DESC);